#! /usr/bin/env python
# -*- coding: utf-8 -*-

import numpy as np
from sklearn import linear_model
import csv

data_train = np.genfromtxt('regression001/data_train.tsv', delimiter='\t')
data_test = np.genfromtxt('regression001/data_test.tsv', delimiter='\t')

f = open('regression001/target_train.tsv')
t = list(csv.reader(f, quoting=csv.QUOTE_NONNUMERIC, delimiter='\t'))
target_train = reduce(lambda x,y: x+y, t, [])

clf = linear_model.LinearRegression()
clf.fit(data_train, target_train)

for data in data_test:
    print clf.intercept_ + np.dot(clf.coef_, data)
